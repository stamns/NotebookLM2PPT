# Changelog

本文档记录了 NotebookLM2PPT 的所有版本更新历史。

## [v0.7.0] - 2026-01-29

### ⚙️ 配置管理与用户体验优化

- **添加配置管理系统**：支持用户设置记忆，自动保存并加载上次的任务设置（如输出目录、DPI、语言等）
- **自定义截图偏移**：新增自定义截图区域偏移坐标功能，支持在 GUI 中设置偏移量，并自动防止超出屏幕边界
- **统一字体功能**：在 MinerU 优化模式下支持统一替换 PPT 字体，提升文档视觉一致性

### 🚀 批量处理增强

- **智能任务配对**：新增批量任务配对对话框，支持智能配对和顺序配对两种模式
- **拖拽功能增强**：批量添加界面支持文件拖拽，提升操作便捷性
- **队列管理优化**：优化任务队列显示，支持区分优化版与未优化版输出文件

### 🎨 GUI 与国际化

- **UI 布局调整**：将语言选择器移至全局设置区域，提升设置项的组织性
- **国际化补充**：为自动化设置、任务管理等新增翻译键，完善中英文多语言支持

### 🛠️ 稳定性与算法改进

- **背景处理优化**：调整背景处理顺序，解决图片覆盖问题，并将边缘多样性检测容差调优至 15

---

## [v0.6.6] - 2026-01-28

### 📦 批量任务支持

- **新增任务队列**：支持批量添加、编辑、删除和后台顺序执行 PDF 转换任务
- **多文件拖放**：支持一次性拖入多个 PDF 和 JSON 文件进行批量处理

### ⚡ 性能与自动化优化

- **极致响应**：移除截图流程中的不必要延迟（由 1-2s 降至 0s），大幅提升自动化执行速度
- **环境检测**：新增微软电脑管家运行状态检测，未运行时提供安装引导

### 🛠️ 修复与改进

- **显示优化**：为全屏图像显示添加边缘填充，修复屏幕边缘黑边问题
- **配置修复**：修复 GUI 加载配置后部分 UI 变量未同步更新的问题
- **文档完善**：更新背景处理算法文档，详细阐述边缘多样性检测原理

---

## [v0.6.5] - 2026-01-27

### 🔄 WPS 支持

- 增加对默认PPT应用为WPS的支持
- 之前只能识别默认是PowerPoint
- 感谢 MadCatPX 的贡献

---

## [v0.6.4] - 2026-01-26

### 🌍 多语言支持

- **添加多语言支持**
- 新增i18n模块，包含中英文翻译文件
- 在GUI中添加语言切换功能，支持简体中文和English
- 重构GUI代码以使用动态文本替换，所有界面文本可翻译
- 更新版本号至0.6.4以反映新功能

---

## [v0.6.3] - 2026-01-25

### 🛠️ 稳定性提升

- **轻微稳定性提升**，如能正常使用无需升级
- 改进PPT窗口检测功能，增加对完整路径的支持
- 优化资源管理器窗口关闭逻辑，支持精确路径匹配
- 添加COM接口获取PPT文件信息，提高稳定性

---

## [v0.6.2] - 2026-01-23

### 🎨 图像修复方法增强与功能优化

本次更新专注于图像修复功能的深度增强和整体用户体验的优化，提供更专业的修复方法和更灵活的使用模式。

#### 核心优化

**6 种专业图像修复方法**
重构图像修复模块，提供多种修复算法选择：
- **智能平滑（推荐）** - 综合效果最佳，适合大多数去除文字、水印的场景
- **边缘均值填充** - 取周围像素平均色填充，适合纯色或简单背景
- **极速纯色填充** - 直接填充单一背景色，仅适合极简底色，速度最快
- **逐层内缩修补** - 由外向内逐层修补，适合细长划痕或线条修复
- **渐变过渡插值** - 计算平滑的曲面过渡，适合带有渐变的背景
- **双调和光影修补** - 计算量大，速度较慢，但能更好保持光影连续性

#### 功能增强

- **🖼️ 仅图片模式**：新增仅图片模式选项，允许用户跳过智能圈选功能
  - 直接将去水印后的 PNG 图片插入 PPT
  - 生成速度更快，但 PPT 内容不可编辑
  - 添加确认对话框，确保用户了解模式特点

- **📖 修复方法说明窗口**：添加详细的图像修复方法说明对话框，帮助用户了解各种方法的特点和适用场景

#### GUI 布局优化

- 重构图像修复模块的界面布局，提供更直观的方法选择体验
- 所有窗口（主窗口、对话框）默认居中显示，改进用户体验
- 使用英文标识保存修复方法配置，提高兼容性

---

## [v0.6.1] - 2026-01-23

### 🖼️ 仅图片模式

- 添加新的仅图片模式选项，允许用户跳过智能圈选功能
- 直接将去水印后的 PNG 图片插入 PPT
- 此模式生成速度更快但内容不可编辑
- 添加相关确认对话框和逻辑处理

---

## [v0.6.0] - 2026-01-23

### 💎 版本核心：迈向极致轻量化

在 v0.6.0 中，我们完成了项目自发布以来最彻底的一次底层重构。通过完全移除 OpenCV 和 Scikit-learn 两大重型依赖，不仅解决了由于二进制包过大导致的启动缓慢问题，更将编译后的程序体积压缩到了极致。

#### 🚀 性能与架构优化

**1. 依赖库全量"瘦身"**
- **移除 Scikit-learn**：将原有的 DBSCAN 边缘多样性检测替换为高性能的 Numpy 原生实现
- **移除 OpenCV**：全屏图像显示引擎全面迁移至 Tkinter
- **体积效益**：编译后的 .exe 或二进制文件大小大大减小，冷启动速度与内存占用大幅优化

**2. 核心算法升级**
- **图像修复 2.0**：采用全新的 Numpy 向量化逻辑替代聚类算法，在保持精度的同时，显著提升了处理大尺寸图片的效率
- **边缘多样性检测**：新增边缘多样性计算工具，专门优化了幻灯片中纯色背景区域的填充效果，过渡更自然

#### 🆕 新增功能与改进

**交互逻辑**
- 新增"一键强行停止"功能
- 为图片查看器添加 ESC 键全局支持
- 无论是在截图、处理还是转换流程中，均可通过 ESC 键或外部信号即时中断任务

**PPT 精炼处理增强**
- 优化了对 PPT 文本块与图片块的识别与填充逻辑
- 修复了"双层图片"问题，确保每个元素块在幻灯片中仅生成唯一且正确的层级

**GUI 体验调整**
- 调整了默认窗口尺寸，使其在各种分辨率的显示器上都能获得最佳的视觉比例

#### 🛠️ 内部维护

- 构建系统更新：同步更新了 pyinstaller 编译指令，移除了不必要的 Hook 和打包路径
- 健壮性提升：新增了边缘多样性检测的专项测试用例，确保算法在各种复杂背景下的稳定性

---

## [v0.5.5] - 2026-01-23

### 🎯 PPT 文本块处理优化

- 在 PPT 精炼处理中增加对图片块的处理
- 确保所有文本块和图片块都能被正确填充
- 修复"双层图片"问题，现在不会出现双层图片

---

## [v0.5.4] - 2026-01-23

### 📂 文件对话框记忆功能

- 在文件选择区域添加"打开"按钮，用于快速访问输出目录
- 改进页码范围处理，支持中文标点符号并自动生成带页码的文件名
- 优化 PPT 输出文件名格式，包含页码范围信息
- 添加对上次打开文件目录的记忆功能，提升用户体验

---

## [v0.5.3] - 2026-01-19

### 📦 依赖补充

- 添加 scikit-learn 到项目依赖中
- 更新 pyproject.toml 中的版本号至 0.5.3
- 取消 build.cmd 中 twine 上传命令的注释

---

## [v0.5.2] - 2026-01-17

### 🎨 MinerU 优化效果改进

- 使用 DBSCAN 聚类算法替代标准差计算边缘多样性，提高准确性
- 移除不再使用的四点颜色差异计算函数
- 调整文本块背景处理逻辑，基于聚类结果决定是否填充纯色

---

## [v0.5.1] - 2026-01-14

### 🐛 修复程序崩溃问题

- 处理幻灯片无背景图时的情况
- 添加对无背景图情况的处理，避免程序崩溃
- 当幻灯片无背景图时，跳过背景替换逻辑中的相关操作

---

## [v0.5.0] - 2026-01-14

### 🆕 基于 MinerU 的 PPT 后处理优化（重大实验性更新）

新增基于 MinerU 的 PPT 后处理优化功能，包括智能文本框筛选、字体统一、高质量图片替换和智能背景处理。

#### 核心功能

- **✨ 智能文本框筛选**：基于 IOU 算法自动识别并保留相关文本框，删除冗余文本框
- **🎨 字体统一处理**：自动将所有文本框字体统一为"微软雅黑"
- **🖼️ 高质量图片替换**：从 MinerU JSON 提取原始高清图片，替换截图图片
- **🎭 智能背景处理**：根据内容特征智能处理背景，实现最佳视觉效果

#### GUI 更新

- 更新 GUI 以支持 MinerU JSON 文件输入
- 添加启动欢迎对话框，显示软件信息和 GitHub 链接，并提供不再显示的选项

#### 文档完善

- 添加相关文档说明
- 新增 compare.png 和 compare2.png 作为示例对比图
- 重构代码结构，将 ppt_combiner.py 移至 utils 目录
- 更新 README 详细说明 MinerU 优化功能的使用方法和优势
- 添加 mineru-technical-details.md 文档详细解释技术实现细节

---

## [v0.4.0] - 2026-01-13

### 🖥️ 图形用户界面 (GUI) 支持

- 重新设计 GUI 布局，增加配置保存和加载功能
- 移除 CLI 模式，专注 GUI 体验
- 优化按钮偏移校准逻辑，自动保存配置
- 增强日志输出和用户提示信息
- 更新 README 文档，移除过时内容
- 增加版本号到 0.4.0

#### 功能增强

- 添加页范围选择功能
- 改进按钮偏移校准流程
- 在 GUI 界面添加页范围输入和偏移校准选项

---

## [v0.3.0] - 2025-12-31

### ⚙️ 电脑管家版本和完成按钮偏移功能

- 添加电脑管家版本检测功能
- 新增完成按钮偏移功能，提高自动化准确性
- 更新编译命令和版本号至 0.3.0

---

## [v0.2.0] - 2025-12-22

### 🖱️ 图形用户界面 (GUI) 支持

- 添加图形用户界面 (GUI) 支持
- 允许用户通过拖拽选择 PDF 文件并设置转换参数
- 修复截图自动化中的按钮位置计算
- 更新 README.md，增加安装和使用指南
- 添加编译指南文档
- 更新依赖项，确保在 Windows 平台上支持拖拽功能
- 修正构建命令中的文件上传格式

---

## [v0.1.0] - 2025-12-22

### 🎉 初始版本

实现 PDF 到 PPT 转换工具的基础功能：

- 添加 PDF 文件转换为 PNG 图像并处理成 PowerPoint 演示文稿的核心功能
- 集成图像查看器，支持全屏显示图像
- 使用 Microsoft 智能圈选工具实现截图自动化
- 添加图像修复功能，用于去除图像中的水印
- 创建实用工具函数，用于处理图像查看、修复和截图自动化
- 开发 PPT 合并工具，在保留原始设计的同时合并生成的 PPT 文件
- 更新 requirements.txt，包含项目所需的依赖项
- 添加模块文档和版本控制，以提高可维护性

---

## 版本说明

本文档遵循 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/) 格式，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范。
